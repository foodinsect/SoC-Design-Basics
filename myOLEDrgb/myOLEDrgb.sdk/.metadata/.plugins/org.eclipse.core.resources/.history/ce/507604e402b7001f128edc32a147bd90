
/*
 * main.c
 *
 *  Created on: 2024. 12. 5.
 *      Author: foodbug
 */

#include "myoledrgb.h"
#include "stdio.h"
#include "xparameters.h"
#include "xil_io.h"
#include "xil_printf.h"

// Base address of the OLED controller
#define OLED_BASEADDR XPAR_MYOLEDRGB_0_S00_AXI_BASEADDR

// OLED controller register offsets
#define INIT_START  0x00  // INIT_START
#define MODE    	0x04  // MODE
#define INIT_DONE   0x08  // INIT DONE

void Delay(unsigned int delay) {
    volatile unsigned int d;
    for (d = 0; d < delay; d++);
}


void StartINIT(unsigned int value) {
    if (value)
    	MYOLEDRGB_mWriteReg(OLED_BASEADDR, INIT_START, 1);  // Reset Inactive
    else
    	MYOLEDRGB_mWriteReg(OLED_BASEADDR, INIT_START, 0);  // Reset Active (Low)
}

void SetMODE(unsigned int value) {
	MYOLEDRGB_mWriteReg(OLED_BASEADDR, MODE, value);  // Reset Inactive
}

int main() {
//	unsigned int i;

	printf("Start\n");
	SetMODE(0);
	Delay(30000);
	StartINIT(1);
	Delay(30000);
	StartINIT(0);

	while (!&(MYOLEDRGB_mReadReg(OLED_BASEADDR, INIT_DONE))) {

	}

	SetMODE(1);

    printf("End\n");

	while (1) {};


    return 0;
}

