
# 실습 1: IP 블록의 주소 디코딩 및 메모리 할당
![waveform](https://velog.velcdn.com/images/foodinsect/post/9d44d43e-a023-4abd-ad22-5b4f984790f4/image.png)

## 1. 개요
이 프로젝트에서는 32비트 상수 값을 3개 저장하는 IP 블록을 구현한다. 상수 값들은 각각 다음의 주소에 저장한다:
- `32'h0200_0100`
- `32'h0200_0104`
- `32'h0200_0108`

이 주소들은 **중앙화된 주소 디코딩** 방식을 사용하여 두 부분으로 나뉜다. 상위 비트는 IP 블록을 선택하고, 하위 비트는 IP 블록 내에서 특정 저장 공간을 선택하는 역할을 한다. 이 방식은 IP 블록이 여러 주소에 걸쳐 효과적으로 사용될 수 있도록 한다.

## 2. 주소 공간 할당
3개의 상수 값에 할당된 주소는 다음과 같다:
- `32'h0200_0100`: 첫 번째 상수 값
- `32'h0200_0104`: 두 번째 상수 값
- `32'h0200_0108`: 세 번째 상수 값

이 시스템에서는 IP 블록 내에서 최대 4개의 주소를 사용할 수 있지만, 그 중 3개의 저장 공간만 실제로 사용하고, 1개의 주소는 사용하지 않는다.

## 3. 중앙화된 주소 디코딩
중앙화된 주소 디코딩은 32비트 주소를 두 부분으로 나누어 처리한다:
- **상위 28비트**: 이 비트들은 IP 블록을 선택하는 데 사용된다. 중앙화된 주소 디코더는 이 상위 비트들이 미리 정해진 IP 블록의 주소와 일치하는지를 검사한다.
- **하위 4비트**: IP 블록 내에서는 하위 4비트를 사용하여 특정 저장 공간에 접근한다.

### 주소 예시:
- `32'h0200_0100`:
  - 상위 28비트: `28'h0200_010`
  - 하위 4비트: `4'h0`
- `32'h0200_0104`:
  - 상위 28비트: `28'h0200_010`
  - 하위 4비트: `4'h4`
- `32'h0200_0108`:
  - 상위 28비트: `28'h0200_010`
  - 하위 4비트: `4'h8`

위의 예시에서 상위 28비트는 중앙 주소 디코더에서 처리되고, 하위 4비트는 IP 블록 내에서 어떤 저장 공간에 접근할지를 결정한다. 3개의 저장 공간만 사용되고, 네 번째 주소(`0x000C`)는 사용하지 않는다.

## 4. 하위 4비트 주소 공간과 32비트 저장 공간
### 하위 4비트와 32비트 저장 공간의 관계
32비트 시스템에서는 **4바이트(32비트) 단위로 메모리 정렬**이 이루어진다. 즉, 주소는 4바이트 단위로 증가하며, 하위 4비트로 나타낼 수 있는 전체 주소 공간 중 일부만 유효한 주소가 된다.

하위 4비트는 총 16개의 값(0x0 ~ 0xF)을 가질 수 있지만, **32비트 저장 공간**의 경우 유효한 주소는 4바이트 간격으로만 존재한다. 그 결과, 하위 4비트에서 4개의 주소만 실제로 사용할 수 있다:
- `0x0000`: 첫 번째 저장 공간
- `0x0004`: 두 번째 저장 공간
- `0x0008`: 세 번째 저장 공간
- `0x000C`: 네 번째 저장 공간

즉, 하위 4비트 주소 공간은 16바이트의 범위를 가질 수 있지만, **4바이트 간격**으로 정렬된 주소 (`0x0`, `0x4`, `0x8`, `0xC`)만 유효하며, 나머지 주소 (`0x1`, `0x2`, `0x3`, `0xF` 등)는 32비트 단위 메모리 정렬 요구 사항을 충족하지 않기 때문에 사용되지 않는다.

### 3개의 주소만 사용하는 이유
비록 4개의 저장 공간을 사용할 수 있는 주소가 할당되었지만, 현재는 3개의 주소(`0x0000`, `0x0004`, `0x0008`)만 사용하고, 현재 설계에서 1개의 저장 공간(`0x000C`)은 사용하지 않는 중이다. 

## 5. 하위 5비트를 사용하는 경우의 주소 공간 확장
**하위 5비트**를 사용하면 더 넓은 주소 공간을 할당할 수 있다. 하위 5비트를 사용하면 총 32개의 주소 공간을 가질 수 있지만, 이 중 일부만 사용될 수 있다.

### 하위 5비트 예시:
- 하위 5비트를 사용할 경우, 32개의 주소 공간(0x0000부터 0x001F까지)을 가질 수 있다.
- 그러나 여전히 유효한 주소는 **4바이트 간격**으로 정렬된 주소로 8개의 주소 공간(`0x0000`, `0x0004`, `0x0008`, `0x000C`, `0x0010`, `0x0014`, `0x0018`, `0x001C`)만 사용된다.

즉, 하위 5비트로는 총 8개의 유효한 주소를 가질 수 있지만, 이 중 현재는 3개의 주소(`0x0000`, `0x0004`, `0x0008`)만 사용하고 나머지 주소는 비어 있다. (현재 설계에서 3개의 주소만 사용)

### 유효한 주소들:
- `0x0000`: 첫 번째 저장 공간
- `0x0004`: 두 번째 저장 공간
- `0x0008`: 세 번째 저장 공간
- `0x000C`: 네 번째 저장 공간 (미사용)
- `0x0010`: 다섯 번째 저장 공간 (미사용)
- `0x0014`: 여섯 번째 저장 공간 (미사용)
- `0x0018`: 일곱 번째 저장 공간 (미사용)
- `0x001C`: 여덟 번째 저장 공간 (미사용)


## 6. 최종 설계 요약
- **상위 28비트**는 중앙화된 주소 디코더가 처리하여 IP 블록을 선택한다.
- **하위 4비트**는 IP 블록 내부에서 저장 공간을 선택하는 데 사용된다.
- IP 블록에는 최대 4개의 저장 공간을 할당할 수 있지만, 현재는 3개만 사용되고 나머지 1개는 비어 있다.
- **메모리 정렬**로 인해 주소는 항상 4바이트 단위로 정렬되어야 하며, `0x000F`와 같은 정렬되지 않은 주소는 사용할 수 없다.
- **하위 5비트**를 사용하면 32개의 주소 공간을 제공할 수 있지만, 현재는 3개의 저장 공간만 사용하고 나머지는 확장성을 위해 예약된 상태이다.

---

